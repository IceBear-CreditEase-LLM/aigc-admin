import{C as ae}from"./CreateAssistantPane-2df9cc84.js";import{_ as oe}from"./NavBack.vue_vue_type_script_setup_true_lang-400666b5.js";import{d as W,k as F,l as K,m as t,j as e,_ as a,$ as d,n as R,aw as M,al as se,am as le,W as u,ac as q,x as S,r as v,o as Y,U as V,av as H,au as $,ax as N,Z as E,F as j,at as ne}from"./utils-15090c58.js";import{_ as Q}from"./UiParentCard.vue_vue_type_script_setup_true_lang-0e150107.js";import{_ as U}from"./UiChildCard.vue_vue_type_script_setup_true_lang-e76ded58.js";import{_ as Z}from"./ConfirmByInput.vue_vue_type_style_index_0_lang-77722b42.js";import{ai as P,_ as z,a5 as G,V as L}from"./index-24ceeda1.js";import{V as m}from"./VCol-e2fcfa86.js";import{V as A}from"./VRow-ab8e6ed5.js";import{V as ie,a as re,b as de,c as ue}from"./VWindowItem-7bde2366.js";import"./ModelSelect.vue_vue_type_script_setup_true_lang-854043e9.js";import"./IconPlus-f64eaa99.js";import"./VTextarea-b1274484.js";import"./VForm-123b6ecf.js";import"./Confirm-aedf99ab.js";const B=b=>(se("data-v-f38990e4"),b=b(),le(),b),ce=B(()=>u("label",null,"创建人",-1)),_e=B(()=>u("label",null,"模型",-1)),me=B(()=>u("label",null,"创建时间",-1)),pe=B(()=>u("label",null,"更新时间",-1)),fe=B(()=>u("label",null,"备注",-1)),he=W({__name:"DetailBaseInfo",props:{info:{default:()=>({})}},setup(b){const i=b;return(T,y)=>(F(),K(A,{class:"my-form waterfall"},{default:t(()=>[e(m,{xs:"12",sm:"6",md:"4",lg:"3"},{default:t(()=>[e(P,{"hide-details":""},{prepend:t(()=>[ce]),default:t(()=>[a(" "+d(i.info.operator),1)]),_:1})]),_:1}),e(m,{xs:"12",sm:"6",md:"4",lg:"3"},{default:t(()=>[e(P,{"hide-details":""},{prepend:t(()=>[_e]),default:t(()=>[a(" "+d(i.info.modelName),1)]),_:1})]),_:1}),e(m,{xs:"12",sm:"6",md:"4",lg:"3"},{default:t(()=>[e(P,{"hide-details":""},{prepend:t(()=>[me]),default:t(()=>[a(" "+d(R(M).dateFormat(i.info.createdAt,"YYYY-MM-DD HH:mm:ss")),1)]),_:1})]),_:1}),e(m,{xs:"12",sm:"6",md:"4",lg:"3"},{default:t(()=>[e(P,{"hide-details":""},{prepend:t(()=>[pe]),default:t(()=>[a(" "+d(R(M).dateFormat(i.info.updatedAt,"YYYY-MM-DD HH:mm:ss")),1)]),_:1})]),_:1}),e(m,{xs:"12",sm:"6",md:"4",lg:"3"},{default:t(()=>[e(P,{"hide-details":""},{prepend:t(()=>[fe]),default:t(()=>[a(" "+d(i.info.remark),1)]),_:1})]),_:1})]),_:1}))}});const be=z(he,[["__scopeId","data-v-f38990e4"]]),ye=W({__name:"ToolsList",emits:["selected"],setup(b,{emit:i}){const T=i,{getLabels:y,loadDictTree:w}=q();w(["assistant_tool_type"]);const l=S({name:""}),s=S({list:[],total:0}),c=v(),p=async(g={})=>{const[f,o]=await $.get({url:"/tools/list",showLoading:c.value.el,data:{...l,...g}});o?(s.list=o.list||[],s.total=o.total):(s.list=[],s.total=0)},_=()=>{c.value.query({page:1})},I=g=>{T("selected",g)};return Y(()=>{p()}),(g,f)=>{const o=V("el-table-column"),n=V("TableWithPager");return F(),K(A,{class:"my-0"},{default:t(()=>[e(m,{cols:"12",lg:"3",md:"4",sm:"6"},{default:t(()=>[e(G,{modelValue:l.name,"onUpdate:modelValue":f[0]||(f[0]=D=>l.name=D),label:"请输入工具名称","hide-details":"",clearable:"",onKeyup:H(_,["enter"]),"onClick:clear":_},null,8,["modelValue","onKeyup"])]),_:1}),e(m,{cols:"12"},{default:t(()=>[e(n,{onQuery:p,ref_key:"tableWithPagerRef",ref:c,"row-class-name":"cursor-pointer",infos:s,height:"400px",onRowClick:I},{default:t(()=>[e(o,{label:"工具ID",prop:"toolId","min-width":"220px"}),e(o,{label:"工具名称",prop:"name","min-width":"200px","show-overflow-tooltip":""}),e(o,{label:"工具描述",prop:"description","min-width":"300px","show-overflow-tooltip":""}),e(o,{label:"工具类型",width:"100px"},{default:t(({row:D})=>[a(d(R(y)([["assistant_tool_type",D.toolType]])),1)]),_:1})]),_:1},8,["infos"])]),_:1})]),_:1})}}});const we=z(ye,[["__scopeId","data-v-018d0a08"]]),ge={class:"text-primary font-weight-black"},xe=u("br",null,null,-1),ve=W({__name:"ToolsTableInfo",setup(b){const{getLabels:i,loadDictTree:T}=q();T(["assistant_tool_type"]);const y=N(),{assistantId:w}=y.query,l=S({name:""}),s=S({list:[],total:0}),c=v(),p=v(),_=S({name:"",toolId:""}),I=v(),g=r=>{let x=[];return x.push({text:"删除",color:"error",click(){f(r)}}),x},f=r=>{_.toolId=r.toolId,_.name=r.name,p.value.show({width:"450px",confirmText:_.name})},o=async(r={})=>{const[x,h]=await $.delete({...r,showSuccess:!0,url:`/assistants/${w}/tools/${_.toolId}`});h&&(p.value.hide(),n())},n=async(r={})=>{const[x,h]=await $.get({url:`/assistants/${w}/tools`,showLoading:c.value.el,data:{...l,...r}});h?(s.list=h.list||[],s.total=h.total):(s.list=[],s.total=0)},D=()=>{c.value.query({page:1})},J=()=>{I.value.show({showActions:!1})},O=async r=>{const[x,h]=await $.post({showSuccess:!0,url:`/assistants/${w}/tools`,data:{toolId:r.toolId}});h&&(I.value.hide(),n())};return Y(()=>{n()}),(r,x)=>{const h=V("ButtonsInForm"),k=V("el-table-column"),X=V("ButtonsInTable"),ee=V("TableWithPager"),te=V("Dialog");return F(),E(j,null,[e(A,null,{default:t(()=>[e(m,{cols:"12",lg:"3",md:"4",sm:"6"},{default:t(()=>[e(G,{modelValue:l.name,"onUpdate:modelValue":x[0]||(x[0]=C=>l.name=C),label:"请输入工具名称","hide-details":"",clearable:"",onKeyup:H(D,["enter"]),"onClick:clear":D},null,8,["modelValue","onKeyup"])]),_:1}),e(m,{cols:"12",lg:"3",md:"4",sm:"6"},{default:t(()=>[e(h,null,{default:t(()=>[e(L,{color:"primary",onClick:J},{default:t(()=>[a("添加工具")]),_:1})]),_:1})]),_:1}),e(m,{cols:"12"},{default:t(()=>[e(ee,{onQuery:n,ref_key:"tableWithPagerRef",ref:c,infos:s},{default:t(()=>[e(k,{label:"工具ID",prop:"toolId","min-width":"220px"}),e(k,{label:"工具名称",prop:"name","min-width":"200px","show-overflow-tooltip":""}),e(k,{label:"工具描述",prop:"description","min-width":"300px","show-overflow-tooltip":""}),e(k,{label:"工具类型",width:"100px"},{default:t(({row:C})=>[a(d(R(i)([["assistant_tool_type",C.toolType]])),1)]),_:1}),e(k,{label:"备注",prop:"remark","min-width":"200px"}),e(k,{label:"操作",width:"80px",fixed:"right"},{default:t(({row:C})=>[e(X,{buttons:g(C),"only-one":""},null,8,["buttons"])]),_:1})]),_:1},8,["infos"])]),_:1})]),_:1}),e(Z,{ref_key:"refConfirmDelete",ref:p,onSubmit:o},{text:t(()=>[a(" 您将要删除 "),u("span",ge,d(_.name),1),a(" 工具"),xe,a(" 确定要继续吗？ ")]),_:1},512),e(te,{ref_key:"refDialogTools",ref:I,persistent:"","max-width":"1200px","retain-focus":!1},{title:t(()=>[a(" 选择工具 ")]),default:t(()=>[e(we,{onSelected:O})]),_:1},512)],64)}}}),Ie=["textContent"],Ve={class:"text-primary font-weight-black"},Te=u("br",null,null,-1),Ue=W({__name:"assistantsDetail",setup(b){const i=N(),T=ne(),{assistantId:y}=i.query,w=v(),l=v({}),s=v(""),c=v(),p=async()=>{let[f,o]=await $.get({showLoading:!0,url:`/assistants/${y}`});o&&(l.value=o)},_=()=>{T.push(`/ai-assistant/assistants/playground?assistantId=${y}`)},I=async(f={})=>{const[o,n]=await $.post({...f,showSuccess:!0,url:`/assistants/${y}/publish`});n&&c.value.hide()},g=()=>{w.value.show({title:"编辑助手",infos:l.value,operateType:"edit"})};return Y(()=>{p()}),(f,o)=>(F(),E(j,null,[e(oe,{backUrl:"/ai-assistant/assistants/list"},{default:t(()=>[a("助手详情")]),_:1}),e(Q,{class:"mt-4"},{header:t(()=>[a(" 名称："+d(l.value.name),1)]),action:t(()=>[u("div",null,[e(L,{class:"ml-4",color:"primary",onClick:_},{default:t(()=>[a("去试试")]),_:1}),e(L,{class:"ml-4",color:"primary",onClick:g},{default:t(()=>[a("编辑")]),_:1})])]),default:t(()=>[e(be,{info:l.value},null,8,["info"])]),_:1}),e(Q,{class:"mt-5"},{header:t(()=>[e(ie,{modelValue:s.value,"onUpdate:modelValue":o[0]||(o[0]=n=>s.value=n),"align-tabs":"start",color:"primary"},{default:t(()=>[e(re,{value:1},{default:t(()=>[a("指令描述")]),_:1})]),_:1},8,["modelValue"])]),default:t(()=>[e(de,{modelValue:s.value,"onUpdate:modelValue":o[1]||(o[1]=n=>s.value=n)},{default:t(()=>[e(ue,{value:1},{default:t(()=>[e(U,{title:"指令描述"},{default:t(()=>[u("div",{class:"whitespace-pre-wrap",textContent:d(l.value.instructions)},null,8,Ie)]),_:1}),e(U,{class:"mt-4",title:"工具集"},{default:t(()=>[e(ve)]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(Z,{ref_key:"refConfirmPublish",ref:c,onSubmit:I},{text:t(()=>[a(" 您将要发布 "),u("span",Ve,d(l.value.name),1),a(" 助手"),Te,a(" 确定要继续吗？ ")]),_:1},512),e(ae,{ref_key:"createAssistantPaneRef",ref:w,onSubmit:p},null,512)],64))}});export{Ue as default};
