import{d as le,at as ne,ac as ie,r as n,x as z,o as re,U as y,k as m,Z as T,j as e,m as t,n as p,av as ce,_ as i,a0 as x,F as B,a5 as N,l as b,W as o,$ as d,ak as ue,aw as de,O as fe,Q as me,a3 as _e,au as C,al as pe,am as ge}from"./utils-15090c58.js";import{_ as he}from"./BaseBreadcrumb.vue_vue_type_style_index_0_lang-f6213a89.js";import{_ as j}from"./UiParentCard.vue_vue_type_script_setup_true_lang-0e150107.js";import{A as ve}from"./AlertBlock-c06c49ed.js";import{_ as A}from"./ConfirmByClick.vue_vue_type_style_index_0_lang-3456f2c5.js";import{I as ye,a as xe,_ as be}from"./TaskOverview.vue_vue_type_script_setup_true_lang-e553984f.js";import{a5 as Ce,V as Q,a0 as ke,M as we,e as Ve,ax as De,K as Ie,I as $e,i as Le,f as Se,ay as Te,_ as Be}from"./index-24ceeda1.js";import{_ as Fe}from"./DialogLog.vue_vue_type_style_index_0_lang-d72a4ceb.js";import{I as Me}from"./IconCircleCheckFilled-2ca5e51b.js";import{V as K}from"./VRow-ab8e6ed5.js";import{V as g}from"./VCol-e2fcfa86.js";import{I as Pe,a as Re,b as q}from"./IconEye-b3d51ee3.js";import"./IconInfoCircle-03c84ef6.js";import"./VAlert-30650f94.js";import"./Confirm-aedf99ab.js";import"./TextLog-183c7d6e.js";const H={running:{text:"合成中",bgColor:"bg-info"},success:{text:"已完成",bgColor:"bg-success"},failed:{text:"失败",bgColor:"bg-error"},waiting:{text:"等待中",bgColor:"bg-warning"},cancel:{text:"已取消",bgColor:"bg-error"}},ze=[{statusText:"等待中",valueText:"个任务",key:"waitingJobCount",color:"warning",bgColor:"lightwarning",icon:ye},{statusText:"已完成",valueText:"个合成任务",key:"successJobCount",color:"success",bgColor:"lightsuccess",icon:Me},{statusText:"总合成时间",valueText:"",key:"totalDurationCount",color:"secondary",bgColor:"lightprimary",icon:xe}],r=v=>(pe("data-v-6af8e823"),v=v(),ge(),v),Ne=["onClick"],je={class:"pa-3"},Ae={class:"text-h5"},Qe={class:"text-subtitle-1 mt-1 text-medium-emphasis text-truncate"},Ke={class:"d-flex align-center justify-space-between mt-2",style:{height:"32px"}},qe={class:"flex-1-1 d-flex justify-space-between text-medium-emphasis"},He=r(()=>o("span",{class:"font-weight-bold"},"这是进行一项操作时必须了解的重要信息",-1)),Oe=r(()=>o("br",null,null,-1)),Ue=r(()=>o("span",{class:"text-primary"},"删除",-1)),Ee=r(()=>o("br",null,null,-1)),Je={class:"text-primary"},We=r(()=>o("br",null,null,-1)),Ze=r(()=>o("span",{class:"font-weight-bold"},"这是进行一项操作时必须了解的重要信息",-1)),Ge=r(()=>o("br",null,null,-1)),Xe=r(()=>o("span",{class:"text-primary"},"取消",-1)),Ye=r(()=>o("br",null,null,-1)),et={class:"text-primary"},tt=r(()=>o("br",null,null,-1)),st=le({name:"DigitalVideoList",__name:"videoList",setup(v){const F=ne(),{getLabels:O,loadDictTree:U}=ie(),E=n({title:"视频列表"}),J=n([]),h=z({title:"",status:null}),_=n([]),k=n(0),w=n(),V=n(),D=n(),I=n(),f=z({uuid:"",title:""}),M=n(),P=n(),$=n(!1);U(["speak_gender"]);const R=async(s={})=>{$.value=!0;const[a,c]=await C.get({url:"/digitalhuman/synthesis/list",showLoading:M.value.$el,data:{...h,...s}});c?(_.value=c.list||[],k.value=c.total):(_.value=[],k.value=0),$.value=!1,P.value.start()},L=()=>{w.value.query({page:1})},S=()=>{w.value.query()},W=s=>{let a=[];return(s==="failed"||s==="success"||s==="running")&&a.push({text:"日志",color:"info",icon:Re,key:"log"}),(s==="waiting"||s==="running")&&a.push({text:"取消",color:"error",icon:q,key:"cancel"}),(s==="failed"||s==="cancel"||s==="success")&&a.push({text:"删除",color:"error",icon:q,key:"delete"}),a},Z=({id:s},a)=>{f.uuid=a.uuid,f.title=a.title,s==="log"?G():s==="cancel"?D.value.show({width:"400px"}):s==="delete"&&I.value.show({width:"400px"})},G=async()=>{V.value.show();let[s,a]=await C.get({url:`/api/digitalhuman/synthesis/${f.uuid}/view`});a&&V.value.setContent(a.synthesisLog)},X=async(s={})=>{const[a,c]=await C.put({...s,showSuccess:!0,url:`/api/digitalhuman/synthesis/${f.uuid}/cancel`});c&&(D.value.hide(),S())},Y=async(s={})=>{const[a,c]=await C.delete({...s,showSuccess:!0,url:`/api/digitalhuman/synthesis/${f.uuid}/delete`});c&&(I.value.hide(),S())},ee=()=>{F.push("/digital-human/edit")},te=({status:s,uuid:a})=>{s==="success"&&F.push(`/digital-human/video-list/detail?uuid=${a}`)};return re(()=>{S()}),(s,a)=>{const c=y("Select"),se=y("refresh-button"),ae=y("ButtonsInForm"),oe=y("NoData");return m(),T(B,null,[e(he,{title:E.value.title,breadcrumbs:J.value},null,8,["title","breadcrumbs"]),e(j,{class:"mb-3"},{default:t(()=>[e(be,{config:p(ze),"request-url":"/digitalhuman/synthesis/count"},null,8,["config"])]),_:1}),e(j,null,{default:t(()=>[e(K,null,{default:t(()=>[e(g,{cols:"12",lg:"3",md:"4",sm:"6"},{default:t(()=>[e(Ce,{density:"compact",modelValue:h.title,"onUpdate:modelValue":a[0]||(a[0]=l=>h.title=l),label:"请输入标题","hide-details":"",clearable:"",variant:"outlined",onKeyup:ce(L,["enter"]),"onClick:clear":L},null,8,["modelValue","onKeyup"])]),_:1}),e(g,{cols:"12",lg:"3",md:"4",sm:"6"},{default:t(()=>[e(c,{onChange:L,label:"请选择状态",mapDictionary:{code:"digitalhuman_synthesis_status"},modelValue:h.status,"onUpdate:modelValue":a[1]||(a[1]=l=>h.status=l)},null,8,["modelValue"])]),_:1}),e(g,{cols:"12",lg:"3",md:"4",sm:"6"},{default:t(()=>[e(ae,null,{default:t(()=>[e(Q,{color:"primary",onClick:ee},{default:t(()=>[i("创建视频")]),_:1}),e(se,{ref_key:"refreshButtonRef",ref:P,onRefresh:R,disabled:$.value},null,8,["disabled"])]),_:1})]),_:1}),e(g,{cols:"12"},{default:t(()=>[e(ve,null,{default:t(()=>[i(" 生成视频的时间可能会比较长，请耐心等待！ ")]),_:1})]),_:1}),e(g,{cols:"12"},{default:t(()=>[e(K,{ref_key:"listContentRef",ref:M,class:x({"justify-center":_.value.length===0})},{default:t(()=>[_.value.length>0?(m(!0),T(B,{key:0},N(_.value,l=>(m(),b(g,{cols:"12",lg:"3",md:"4",sm:"6"},{default:t(()=>[e(ke,{elevation:"10",rounded:"md"},{default:t(()=>[o("a",{class:"card-list-item text-textPrimary text-decoration-none",href:"javascript: void(0)",onClick:u=>te(l)},[o("div",{class:x(["status-corner-mark",p(H)[l.status].bgColor])},d(p(H)[l.status].text),3),e(we,{src:l.digitalHumanPerson.cover,height:"180px",cover:"",class:"rounded-t-md align-end text-right"},{default:t(()=>[o("div",je,[e(Ve,{onClick:a[2]||(a[2]=ue(()=>{},["stop"])),class:"bg-surface text-body-2 font-weight-medium",variant:"flat",size:"small",text:`${l.videoDuration||"0s"}/${l.videoSize}`},null,8,["text"])])]),_:2},1032,["src"]),e(De,{class:"pa-5"},{default:t(()=>[o("h5",Ae,d(l.title),1),o("p",Qe,d(l.ttsText),1),o("div",Ke,[o("div",qe,[o("span",null,d(p(de).dateFromNow(l.createdAt)),1),o("span",null,d(l.digitalHumanPerson.cname)+" ("+d(p(O)([["speak_gender",l.digitalHumanPerson.gender]]))+") ",1)]),e(Q,{class:"ml-6",size:"x-small",color:"inherit",icon:"",variant:"text"},{default:t(()=>[e(p(Pe),{width:"14","stroke-width":"1.5"}),e(Ie,{activator:"parent"},{default:t(()=>[e($e,{density:"compact","onClick:select":u=>Z(u,l)},{default:t(()=>[(m(!0),T(B,null,N(W(l.status),u=>(m(),b(Le,{key:u.key,value:u.key,"hide-details":"","min-height":"38"},{prepend:t(()=>[(m(),b(fe(u.icon),{size:16,class:x(["mr-2",[`text-${u.color}`]])},null,8,["class"]))]),default:t(()=>[e(Se,{class:x([`text-${u.color}`])},{default:t(()=>[i(d(u.text),1)]),_:2},1032,["class"])]),_:2},1032,["value"]))),128))]),_:2},1032,["onClick:select"])]),_:2},1024)]),_:2},1024)])]),_:2},1024)],8,Ne)]),_:2},1024)]),_:2},1024))),256)):(m(),b(oe,{key:1}))]),_:1},8,["class"]),me(e(Te,{class:"mt-5",ref_key:"refPager",ref:w,total:k.value,"page-sizes":[12,20,40,60,120],onQuery:R},null,8,["total"]),[[_e,_.value.length>0]])]),_:1})]),_:1})]),_:1}),e(Fe,{ref_key:"refDialogLog",ref:V},null,512),e(A,{ref_key:"refConfirmDelete",ref:I,onSubmit:Y},{text:t(()=>[He,Oe,i(" 此操作将会"),Ue,i("该视频"),Ee,i(" 标题："),o("span",Je,d(f.title),1),We,i(" 你还要继续吗？ ")]),_:1},512),e(A,{ref_key:"refConfirmCancel",ref:D,onSubmit:X},{text:t(()=>[Ze,Ge,i(" 此操作将会"),Xe,i("该视频"),Ye,i(" 标题："),o("span",et,d(f.title),1),tt,i(" 你还要继续吗？ ")]),_:1},512)],64)}}});const yt=Be(st,[["__scopeId","data-v-6af8e823"]]);export{yt as default};
