import{r as _,i as R,z as w,x as S,U as A,k as h,l as $,m as a,j as e,_ as f,n as t,c as j,W as N,Z as B,$ as z,Y as E,X as G,ac as H,ax as O,D as Q,o as W,S as X,Q as U,a3 as Y,L as Z,F as J,au as K,a8 as T,a1 as ee}from"./utils-15090c58.js";import{_ as ae}from"./BaseBreadcrumb.vue_vue_type_style_index_0_lang-f6213a89.js";import{_ as D}from"./UiParentCard.vue_vue_type_script_setup_true_lang-0e150107.js";import{_ as te}from"./UiChildCard.vue_vue_type_script_setup_true_lang-e76ded58.js";import{_ as se}from"./Explain.vue_vue_type_style_index_0_lang-9177768e.js";import{S as le}from"./SpeakerSelector-9a1a6be6.js";import{V as C}from"./VRow-ab8e6ed5.js";import{V as m}from"./VCol-e2fcfa86.js";import{a4 as b,ai as oe,a5 as P,_ as re,O as ie,al as ne}from"./index-24ceeda1.js";import{V as I}from"./VForm-123b6ecf.js";import{V as de}from"./VTextarea-b1274484.js";import{V as ue}from"./VSlider-55ddc261.js";import{_ as me}from"./AiAudio.vue_vue_type_style_index_0_lang-ab9d5699.js";import"./IconInfoCircle-03c84ef6.js";import"./IconCircleCheckFilled-2ca5e51b.js";const pe={__name:"Left",setup(F,{expose:k}){const v=_(),g=_(),i=R("provideSynthesisVoice"),{formData:r}=w(i),u=S({selectedSpeaker:{}}),o=S({provider:[l=>!!l||"请选择供应"],lang:[l=>!!l||"请选择语言"],speakName:[l=>!!l||"请选择发声人"]}),c=()=>{g.value.reload({lang:r.value.lang,provider:r.value.provider})};return k({validate(){return v.value.validate()}}),(l,s)=>{const n=A("Select");return h(),$(I,{ref_key:"refForm",ref:v,class:"my-form"},{default:a(()=>[e(C,null,{default:a(()=>[e(m,{cols:"12"},{default:a(()=>[e(b,{class:"mb-2"},{default:a(()=>[f("供应")]),_:1}),e(n,{mapDictionary:{code:"speak_provider"},placeholder:"请选择供应",modelValue:t(r).provider,"onUpdate:modelValue":s[0]||(s[0]=d=>t(r).provider=d),onChange:c},null,8,["modelValue"])]),_:1}),e(m,{cols:"12"},{default:a(()=>[e(b,{class:"mb-2"},{default:a(()=>[f("语言")]),_:1}),e(n,{mapDictionary:{code:"speak_lang"},placeholder:"请选择语言",modelValue:t(r).lang,"onUpdate:modelValue":s[1]||(s[1]=d=>t(r).lang=d),infos:t(i).selectedLanguage,"onUpdate:infos":s[2]||(s[2]=d=>t(i).selectedLanguage=d),onChange:c},null,8,["modelValue","infos"])]),_:1}),e(m,{cols:"12"},{default:a(()=>[e(b,{class:"mb-2 required"},{default:a(()=>[f("请选择需要合成的发声人")]),_:1}),e(oe,{rules:o.speakName,modelValue:t(r).speakName,"onUpdate:modelValue":s[5]||(s[5]=d=>t(r).speakName=d)},{default:a(()=>[e(le,{ref_key:"refSpeakerSelector",ref:g,modelValue:t(r).speakName,"onUpdate:modelValue":s[3]||(s[3]=d=>t(r).speakName=d),infos:u.selectedSpeaker,"onUpdate:infos":s[4]||(s[4]=d=>u.selectedSpeaker=d)},null,8,["modelValue","infos"])]),_:1},8,["rules","modelValue"])]),_:1})]),_:1})]),_:1},512)}}},fe={key:0,class:"text-primary font-weight-bold"},ce={style:{width:"300px"}},_e={__name:"Right",setup(F,{expose:k}){const v=_(),g=R("provideSynthesisVoice"),{formData:i}=w(g),r=S({speedConfig:{min:.5,max:2,step:.1}}),{speedConfig:u}=w(r),o=S({title:[l=>!!l||"请输入标题"],text:[l=>!!l||"请输入语音播放文本"],speed:[l=>{if(l){let{min:s,max:n}=r.speedConfig;return l<s?"语速不能低于"+s+"倍":l>n?"语速不能高于"+n+"倍":!0}else return"请设置语速"}]}),c=j(()=>{let{label:l}=g.selectedLanguage;return l?l.trim().replace(/([^(（]+)(.*)$/,"$1"):""});return k({validate(){return v.value.validate()}}),(l,s)=>(h(),$(I,{ref_key:"refForm",ref:v,class:"my-form"},{default:a(()=>[e(C,null,{default:a(()=>[e(m,{cols:"12"},{default:a(()=>[e(b,{class:"mb-2 required"},{default:a(()=>[f("标题"),e(se,{class:"ml-2"},{default:a(()=>[f("用于列表展示和搜索，能够快速了解基本信息")]),_:1})]),_:1}),e(P,{density:"compact",variant:"outlined",placeholder:"请输入标题","hide-details":"auto",rules:o.title,modelValue:t(i).title,"onUpdate:modelValue":s[0]||(s[0]=n=>t(i).title=n),modelModifiers:{trim:!0},clearable:""},null,8,["rules","modelValue"])]),_:1}),e(m,{cols:"12"},{default:a(()=>[e(b,{class:"mb-2 required",style:{"white-space":"inherit"}},{default:a(()=>[N("div",null,[f(" 请输入"),c.value?(h(),B("span",fe,"「 "+z(c.value)+" 」",1)):E("",!0),f("语音播放文本，文本内容小于200个字(包括标点符号)。 ")])]),_:1}),e(de,{modelValue:t(i).text,"onUpdate:modelValue":s[1]||(s[1]=n=>t(i).text=n),modelModifiers:{trim:!0},rules:o.text,placeholder:"语音播放文本",counter:"",rows:"5",maxlength:"200"},null,8,["modelValue","rules"])]),_:1}),e(m,{cols:"12"},{default:a(()=>[e(b,{class:"mb-2 required"},{default:a(()=>[f("语速")]),_:1}),N("div",ce,[e(ue,{density:"compact",modelValue:t(i).speed,"onUpdate:modelValue":s[3]||(s[3]=n=>t(i).speed=n),color:"primary",max:t(u).max,min:t(u).min,step:t(u).step,"thumb-label":"",rules:o.speed,"hide-details":"auto"},{append:a(()=>[e(P,{modelValue:t(i).speed,"onUpdate:modelValue":s[2]||(s[2]=n=>t(i).speed=n),modelModifiers:{number:!0},type:"number",density:"compact",max:t(u).max,min:t(u).min,step:t(u).step,style:{width:"80px"}},null,8,["modelValue","max","min","step"])]),_:1},8,["modelValue","max","min","step","rules"])])]),_:1}),G(l.$slots,"default")]),_:3})]),_:3},512))}};const ve={class:"hv-center py-3"},ge={__name:"synthesisVoice",setup(F){const{mappings:k,loadDictTree:v}=H(),g=O(),i=_(),r=_(),u=_(),o=S({style:{showPreview:!1,loadingPreview:!1},formData:{provider:"",lang:"",speakName:"",text:"",title:"",speed:1},selectedLanguage:{label:"",value:""},selectedSpeaker:{speakName:"",speakCname:"",headImg:"",speakDemo:"",gender:"",ageGroup:"",subTitle:""},selectedDigitalHuman:{name:"",cname:"",cover:"",video:""},audioInfo:{src:"",gender:"",type:"complex"}}),{style:c,formData:l,selectedSpeaker:s}=w(o);Q("provideSynthesisVoice",o);const n=_({title:"声文模块"}),d=_([{text:"声音列表",disabled:!1,href:"#"},{text:"声音合成",disabled:!0,href:"#"}]),M=p=>{o.style.loadingPreview=!0,o.style.showPreview=!0,setTimeout(()=>{ne.scrollTo(u.value.$el,500),T.assign(o.audioInfo,{src:p.s3Url,gender:p.gender})},100),setTimeout(()=>{o.style.loadingPreview=!1},500)},q=async()=>{const{valid:p}=await i.value.validate(),{valid:x}=await r.value.validate();if(p&&x){const[V,y]=await K.post({showLoading:"btn#btnSubmit",showSuccess:!0,url:"/api/voice/tts",data:T.omit(o.formData,["provider","lang"])});y?M(y):o.style.showPreview=!1}else{let V="请处理页面标错的地方后，再尝试提交";ee.warning(V)}};return W(async()=>{var y,L;await v(["speak_provider","speak_lang"]);let{provider:p,lang:x,speakName:V}=g.query;p&&((y=k.speak_provider)!=null&&y[p])&&(o.formData.provider=p),x&&((L=k.speak_lang)!=null&&L[x])&&(o.formData.lang=x),V&&(o.formData.speakName=V)}),(p,x)=>{const V=A("AiBtn"),y=X("loading");return h(),B(J,null,[e(ae,{title:n.value.title,breadcrumbs:d.value},null,8,["title","breadcrumbs"]),e(C,null,{default:a(()=>[e(m,{cols:"12",md:"6"},{default:a(()=>[e(D,null,{default:a(()=>[e(pe,{ref_key:"refFormLeft",ref:i},null,512)]),_:1})]),_:1}),e(m,{cols:"12",md:"6"},{default:a(()=>[e(D,null,{default:a(()=>[e(_e,{ref_key:"refFormRight",ref:r},{default:a(()=>[e(m,{cols:"12",class:"mt-4"},{default:a(()=>[N("div",ve,[e(V,{id:"btnSubmit",color:"secondary",width:"200",height:"48",size:"large",onClick:q},{default:a(()=>[f("开始合成")]),_:1})])]),_:1})]),_:1},512)]),_:1})]),_:1}),e(ie,null,{default:a(()=>[U(e(m,{cols:"12"},{default:a(()=>[e(D,null,{default:a(()=>[e(m,{cols:"12",class:"pt-10"},{default:a(()=>[U((h(),$(te,{title:"合成音频"},{default:a(()=>[e(me,Z({...o.audioInfo},{ref_key:"refAiAudio",ref:u}),null,16)]),_:1})),[[y,t(c).loadingPreview]])]),_:1})]),_:1})]),_:1},512),[[Y,t(c).showPreview]])]),_:1})]),_:1})],64)}}},Te=re(ge,[["__scopeId","data-v-ed29fab9"]]);export{Te as default};
