import{C as ae}from"./CreateAssistantPane-0a8e64c0.js";import{_ as oe}from"./NavBack.vue_vue_type_script_setup_true_lang-88a0733f.js";import{d as W,k as F,l as K,m as t,j as e,_ as a,$ as d,n as R,aB as M,al as se,am as le,W as u,ac as q,x as B,r as v,o as L,U as V,aA as H,av as $,au as N,Z as E,F as j,at as ne}from"./utils-1d42a8ce.js";import{_ as Q}from"./UiParentCard.vue_vue_type_script_setup_true_lang-26d4ddeb.js";import{_ as U}from"./UiChildCard.vue_vue_type_script_setup_true_lang-26e2a5c8.js";import{_ as Z}from"./ConfirmByInput.vue_vue_type_style_index_0_lang-c4ee9bbd.js";import{ae as P,_ as z,a5 as G,V as A}from"./index-19641142.js";import{V as m}from"./VCol-8f634d17.js";import{V as Y}from"./VRow-344d3b15.js";import{V as re,a as ie,b as de,c as ue}from"./VWindowItem-356fd66b.js";import"./ModelSelect.vue_vue_type_script_setup_true_lang-ce0ed5ba.js";import"./CustomUpload-08ddf4fa.js";import"./IconPlus-09ad8ef8.js";import"./VTextarea-a1014230.js";import"./VForm-5ef8cb3b.js";import"./Confirm-43e4aa28.js";const S=b=>(se("data-v-f38990e4"),b=b(),le(),b),ce=S(()=>u("label",null,"创建人",-1)),_e=S(()=>u("label",null,"模型",-1)),me=S(()=>u("label",null,"创建时间",-1)),pe=S(()=>u("label",null,"更新时间",-1)),fe=S(()=>u("label",null,"备注",-1)),he=W({__name:"DetailBaseInfo",props:{info:{default:()=>({})}},setup(b){const r=b;return(T,y)=>(F(),K(Y,{class:"my-form waterfall"},{default:t(()=>[e(m,{xs:"12",sm:"6",md:"4",lg:"3"},{default:t(()=>[e(P,{"hide-details":""},{prepend:t(()=>[ce]),default:t(()=>[a(" "+d(r.info.operator),1)]),_:1})]),_:1}),e(m,{xs:"12",sm:"6",md:"4",lg:"3"},{default:t(()=>[e(P,{"hide-details":""},{prepend:t(()=>[_e]),default:t(()=>[a(" "+d(r.info.modelName),1)]),_:1})]),_:1}),e(m,{xs:"12",sm:"6",md:"4",lg:"3"},{default:t(()=>[e(P,{"hide-details":""},{prepend:t(()=>[me]),default:t(()=>[a(" "+d(R(M).dateFormat(r.info.createdAt,"YYYY-MM-DD HH:mm:ss")),1)]),_:1})]),_:1}),e(m,{xs:"12",sm:"6",md:"4",lg:"3"},{default:t(()=>[e(P,{"hide-details":""},{prepend:t(()=>[pe]),default:t(()=>[a(" "+d(R(M).dateFormat(r.info.updatedAt,"YYYY-MM-DD HH:mm:ss")),1)]),_:1})]),_:1}),e(m,{xs:"12",sm:"6",md:"4",lg:"3"},{default:t(()=>[e(P,{"hide-details":""},{prepend:t(()=>[fe]),default:t(()=>[a(" "+d(r.info.remark),1)]),_:1})]),_:1})]),_:1}))}});const be=z(he,[["__scopeId","data-v-f38990e4"]]),ye=W({__name:"ToolsList",emits:["selected"],setup(b,{emit:r}){const T=r,{getLabels:y,loadDictTree:w}=q();w(["assistant_tool_type"]);const l=B({name:""}),s=B({list:[],total:0}),c=v(),p=async(g={})=>{const[f,o]=await $.get({url:"/tools/list",showLoading:c.value.el,data:{...l,...g}});o?(s.list=o.list||[],s.total=o.total):(s.list=[],s.total=0)},_=()=>{c.value.query({page:1})},I=g=>{T("selected",g)};return L(()=>{p()}),(g,f)=>{const o=V("el-table-column"),n=V("TableWithPager");return F(),K(Y,{class:"my-0"},{default:t(()=>[e(m,{cols:"12",lg:"3",md:"4",sm:"6"},{default:t(()=>[e(G,{modelValue:l.name,"onUpdate:modelValue":f[0]||(f[0]=D=>l.name=D),label:"请输入工具名称","hide-details":"",clearable:"",onKeyup:H(_,["enter"]),"onClick:clear":_},null,8,["modelValue","onKeyup"])]),_:1}),e(m,{cols:"12"},{default:t(()=>[e(n,{onQuery:p,ref_key:"tableWithPagerRef",ref:c,"row-class-name":"cursor-pointer",infos:s,height:"400px",onRowClick:I},{default:t(()=>[e(o,{label:"工具ID",prop:"toolId","min-width":"220px"}),e(o,{label:"工具名称",prop:"name","min-width":"200px","show-overflow-tooltip":""}),e(o,{label:"工具描述",prop:"description","min-width":"300px","show-overflow-tooltip":""}),e(o,{label:"工具类型",width:"100px"},{default:t(({row:D})=>[a(d(R(y)([["assistant_tool_type",D.toolType]])),1)]),_:1})]),_:1},8,["infos"])]),_:1})]),_:1})}}});const we=z(ye,[["__scopeId","data-v-018d0a08"]]),ge={class:"text-primary font-weight-black"},xe=u("br",null,null,-1),ve=W({__name:"ToolsTableInfo",setup(b){const{getLabels:r,loadDictTree:T}=q();T(["assistant_tool_type"]);const y=N(),{assistantId:w}=y.query,l=B({name:""}),s=B({list:[],total:0}),c=v(),p=v(),_=B({name:"",toolId:""}),I=v(),g=i=>{let x=[];return x.push({text:"删除",color:"error",click(){f(i)}}),x},f=i=>{_.toolId=i.toolId,_.name=i.name,p.value.show({width:"450px",confirmText:_.name})},o=async(i={})=>{const[x,h]=await $.delete({...i,showSuccess:!0,url:`/assistants/${w}/tools/${_.toolId}`});h&&(p.value.hide(),n())},n=async(i={})=>{const[x,h]=await $.get({url:`/assistants/${w}/tools`,showLoading:c.value.el,data:{...l,...i}});h?(s.list=h.list||[],s.total=h.total):(s.list=[],s.total=0)},D=()=>{c.value.query({page:1})},J=()=>{I.value.show({showActions:!1})},O=async i=>{const[x,h]=await $.post({showSuccess:!0,url:`/assistants/${w}/tools`,data:{toolId:i.toolId}});h&&(I.value.hide(),n())};return L(()=>{n()}),(i,x)=>{const h=V("ButtonsInForm"),k=V("el-table-column"),X=V("ButtonsInTable"),ee=V("TableWithPager"),te=V("Dialog");return F(),E(j,null,[e(Y,null,{default:t(()=>[e(m,{cols:"12",lg:"3",md:"4",sm:"6"},{default:t(()=>[e(G,{modelValue:l.name,"onUpdate:modelValue":x[0]||(x[0]=C=>l.name=C),label:"请输入工具名称","hide-details":"",clearable:"",onKeyup:H(D,["enter"]),"onClick:clear":D},null,8,["modelValue","onKeyup"])]),_:1}),e(m,{cols:"12",lg:"3",md:"4",sm:"6"},{default:t(()=>[e(h,null,{default:t(()=>[e(A,{color:"primary",onClick:J},{default:t(()=>[a("添加工具")]),_:1})]),_:1})]),_:1}),e(m,{cols:"12"},{default:t(()=>[e(ee,{onQuery:n,ref_key:"tableWithPagerRef",ref:c,infos:s},{default:t(()=>[e(k,{label:"工具ID",prop:"toolId","min-width":"220px"}),e(k,{label:"工具名称",prop:"name","min-width":"200px","show-overflow-tooltip":""}),e(k,{label:"工具描述",prop:"description","min-width":"300px","show-overflow-tooltip":""}),e(k,{label:"工具类型",width:"100px"},{default:t(({row:C})=>[a(d(R(r)([["assistant_tool_type",C.toolType]])),1)]),_:1}),e(k,{label:"备注",prop:"remark","min-width":"200px"}),e(k,{label:"操作",width:"80px",fixed:"right"},{default:t(({row:C})=>[e(X,{buttons:g(C),"only-one":""},null,8,["buttons"])]),_:1})]),_:1},8,["infos"])]),_:1})]),_:1}),e(Z,{ref_key:"refConfirmDelete",ref:p,onSubmit:o},{text:t(()=>[a(" 您将要删除 "),u("span",ge,d(_.name),1),a(" 工具"),xe,a(" 确定要继续吗？ ")]),_:1},512),e(te,{ref_key:"refDialogTools",ref:I,persistent:"","max-width":"1200px","retain-focus":!1},{title:t(()=>[a(" 选择工具 ")]),default:t(()=>[e(we,{onSelected:O})]),_:1},512)],64)}}}),Ie=["textContent"],Ve={class:"text-primary font-weight-black"},Te=u("br",null,null,-1),Ke=W({__name:"assistantsDetail",setup(b){const r=N(),T=ne(),{assistantId:y}=r.query,w=v(),l=v({}),s=v(""),c=v(),p=async()=>{let[f,o]=await $.get({showLoading:!0,url:`/assistants/${y}`});o&&(l.value=o)},_=()=>{T.push(`/ai-assistant/assistants/playground?assistantId=${y}`)},I=async(f={})=>{const[o,n]=await $.post({...f,showSuccess:!0,url:`/assistants/${y}/publish`});n&&c.value.hide()},g=()=>{w.value.show({title:"编辑助手",infos:l.value,operateType:"edit"})};return L(()=>{p()}),(f,o)=>(F(),E(j,null,[e(oe,{backUrl:"/ai-assistant/assistants/list"},{default:t(()=>[a("助手详情")]),_:1}),e(Q,{class:"mt-4"},{header:t(()=>[a(" 名称："+d(l.value.name),1)]),action:t(()=>[u("div",null,[e(A,{class:"ml-4",color:"primary",onClick:_},{default:t(()=>[a("去试试")]),_:1}),e(A,{class:"ml-4",color:"primary",onClick:g},{default:t(()=>[a("编辑")]),_:1})])]),default:t(()=>[e(be,{info:l.value},null,8,["info"])]),_:1}),e(Q,{class:"mt-5"},{header:t(()=>[e(re,{modelValue:s.value,"onUpdate:modelValue":o[0]||(o[0]=n=>s.value=n),"align-tabs":"start",color:"primary"},{default:t(()=>[e(ie,{value:1},{default:t(()=>[a("指令描述")]),_:1})]),_:1},8,["modelValue"])]),default:t(()=>[e(de,{modelValue:s.value,"onUpdate:modelValue":o[1]||(o[1]=n=>s.value=n)},{default:t(()=>[e(ue,{value:1},{default:t(()=>[e(U,{title:"指令描述"},{default:t(()=>[u("div",{class:"whitespace-pre-wrap",textContent:d(l.value.instructions)},null,8,Ie)]),_:1}),e(U,{class:"mt-4",title:"工具集"},{default:t(()=>[e(ve)]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(Z,{ref_key:"refConfirmPublish",ref:c,onSubmit:I},{text:t(()=>[a(" 您将要发布 "),u("span",Ve,d(l.value.name),1),a(" 助手"),Te,a(" 确定要继续吗？ ")]),_:1},512),e(ae,{ref_key:"createAssistantPaneRef",ref:w,onSubmit:p},null,512)],64))}});export{Ke as default};
